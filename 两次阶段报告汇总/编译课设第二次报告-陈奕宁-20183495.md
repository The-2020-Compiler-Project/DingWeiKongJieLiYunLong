### 编译课设第二次报告-陈奕宁-20183495

**一、本周工作情况：**

本周我的工作主要是对语义分析的翻译文法设计和完善，包括对if和while的语句的一些语义动作和嵌套进行设计和编写实现，同时对算术表达式和表达式文法等文法进行分步骤调试，然后进行整个语义分析模块的整合，同时对整个前端，对语义分析和符号表，语义分析和词法分析的过程进行连接和整合。对整个前端进行整体的测试和输出。

**二、本周各次课的进度（个人）：**

7.6：基本完成语义分析各模块的调试，同时对扫描器的扫描过程和语义分析的过程进行了修改，重新确定了以一个全局变量curtoken作为扫描器当前读到的单词，同时在每个子函数的末尾，如果这个函数对应的文法可以读取空的情况，进行直接返回值为1的处理，此时curtoken不进行预读，反之其他情况，需要对curtoken进行预读下一个单词，方便下一个函数直接对curtoken进行操作。同时对一些四元式，进行重新的设计和修订，方便后端的生成目标代码的处理。

7.8：对所有模块的分别调试和测试输出结束，同时考虑了if和while的嵌套的情况，对这种情况进行调试，对一些赋值语句声明语句的错误分析，进行了完善。同时完成前端的整合，以及修改语义动作，抛出异常，对接口的处理，方便后端和其他模块进行调用。

**三、遇到的问题：**

1、最主要的问题，在于重新确定扫描器的读取和语义分析调用的联系，因为词法分析扫描器是通过scaner函数进行扫描，每次调用一次会自动返回当前的单词，同时调用之后，指针会后移一位，所以涉及到了单词的预读以及不读（保留指针位置不动）的两个关键问题，因为只有通过扫描出来的单词才能根据当前设定的文法，进行下一步的操作。通过在对while和if的嵌套过程中，出现的一些问题进行分析，发现会有多次预读，和未预读下一位单词的情况出现，对此进行了订正。

2、第二个问题就是对算术表达式文法和表达式文法的语义动作以及四元式生成的设计问题，由于扫出来的单词全部都是string类型的值或者标识符，对此需要分情况考虑，如果是标识符，需要通过查表来确定当前标识符的值，如果是常数，需要调用系统库里的函数来进行转换为浮点数处理，同时表达式文法和算术表达式也是互相调用的，需要考虑整体的调用问题。同时，对于表达式文法，遇到一些操作符（&&，==等双字符的操作符），需要在生成四元式的时候按照规定好的，转化成某种单字符的操作符，用来生成汇编代码更加方便一些。

